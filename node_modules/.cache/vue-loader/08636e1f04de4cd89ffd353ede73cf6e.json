{"remainingRequest":"/Users/xiekun/Pictures/sabi/dasabi/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/xiekun/Pictures/sabi/dasabi/src/components/user/edit.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/xiekun/Pictures/sabi/dasabi/src/components/user/edit.vue","mtime":1593668399406},{"path":"/Users/xiekun/Pictures/sabi/dasabi/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xiekun/Pictures/sabi/dasabi/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/xiekun/Pictures/sabi/dasabi/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xiekun/Pictures/sabi/dasabi/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldENvb2tpZSwgc2V0Q29va2llLCByZW1vdmVDb29raWUgfSBmcm9tICJAL2xpYnMvY29va2llIjsKaW1wb3J0IHsgZWRpdFNldHRpbmcgfSBmcm9tICJAL2FwaS9tb2R1bGVzL3VzZXIiOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJlZGl0IiwKICBkYXRhKCkgewogICAgLy/pgq7nrrHpqozor4EKICAgIHZhciB1c2VyRW1haWwgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7CiAgICAgIGNvbnN0IG1haWxSZWcgPSAvXihbYS16QS1aMC05Xy1dKStAKFthLXpBLVowLTlfLV0pKyguW2EtekEtWjAtOV8tXSkrLzsKICAgICAgLy8gaWYgKCF2YWx1ZSkgewogICAgICAvLyAgIHJldHVybiBjYWxsYmFjaygpOwogICAgICAvLyB9CiAgICAgIGlmICghdmFsdWUpIHsKICAgICAgICByZXR1cm4gY2FsbGJhY2sobmV3IEVycm9yKCLpgq7nrrHkuI3og73kuLrnqboiKSk7CiAgICAgIH0KICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgaWYgKG1haWxSZWcudGVzdCh2YWx1ZSkpIHsKICAgICAgICAgIGNhbGxiYWNrKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcigi6K+36L6T5YWl5q2j56Gu55qE6YKu566x5qC85byPIikpOwogICAgICAgIH0KICAgICAgfSwgMTAwKTsKICAgIH07CiAgICAvL+aJi+acuumqjOivgQogICAgdmFyIGNoZWNrUGhvbmUgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7CiAgICAgIGNvbnN0IHBob25lUmVnID0gMTEgJiYgL14oKDEzfDE0fDE1fDE3fDE4KVswLTldezF9XGR7OH0pJC87CiAgICAgIHRoaXMuYnRudHh0ID0gIuiOt+WPlumqjOivgeeggSI7CiAgICAgIHRoaXMudGltZSA9IDA7CiAgICAgIGlmICghdmFsdWUpIHsKICAgICAgICByZXR1cm4gY2FsbGJhY2sobmV3IEVycm9yKCLmiYvmnLrlj7fkuI3og73kuLrnqboiKSk7CiAgICAgIH0KICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgLy8gTnVtYmVyLmlzSW50ZWdlcuaYr2VzNumqjOivgeaVsOWtl+aYr+WQpuS4uuaVtOaVsOeahOaWueazlSzlrp7pmYXovpPlhaXnmoTmlbDlrZfmgLvmmK/or4bliKvmiJDlrZfnrKbkuLIKICAgICAgICAvLyDmiYDku6XlnKjliY3pnaLliqDkuobkuIDkuKor5a6e546w6ZqQ5byP6L2s5o2iCgogICAgICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcigrdmFsdWUpKSB7CiAgICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoIuivt+i+k+WFpeaVsOWtl+WAvCIpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHBob25lUmVnLnRlc3QodmFsdWUpKSB7CiAgICAgICAgICAgIHRoaXMudGltZSA9IDYwOwogICAgICAgICAgICB0aGlzLmJ0bnR4dCA9ICLojrflj5bpqozor4HnoIEiOwogICAgICAgICAgICB0aGlzLmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgICAgIGNhbGxiYWNrKCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoIueUteivneWPt+eggeagvOW8j+S4jeato+ehriIpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIDEwMCk7CiAgICB9OwogICAgcmV0dXJuIHsKICAgICAgZHluYW1pY1ZhbGlkYXRlRm9ybTogewogICAgICAgIGRvbWFpbnM6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgdmFsdWU6ICIiCiAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICBpZDogIiIsCiAgICAgICAgZW1haWw6ICIiLAogICAgICAgIHRlbDogIiIKICAgICAgICAvLyBzY2hvb2w6IiIsCiAgICAgICAgLy8gZGVzY3JpYmU6IiIKICAgICAgfSwKICAgICAgc2V0dGluZ1J1bGVzOiB7CiAgICAgICAgZW1haWw6IHsgdmFsaWRhdG9yOiB1c2VyRW1haWwsIHRyaWdnZXI6ICJibHVyIiB9LAogICAgICAgIHRlbDogeyB2YWxpZGF0b3I6IGNoZWNrUGhvbmUsIHRyaWdnZXI6ICJibHVyIiB9CiAgICAgIH0KICAgIH07CiAgfSwKICBtb3VudGVkKCkgewogICAgbGV0IHVzZXIgPSBKU09OLnBhcnNlKGdldENvb2tpZSgidXNlciIpIHx8ICJ7fSIpOwogICAgdGhpcy5keW5hbWljVmFsaWRhdGVGb3JtLmVtYWlsID0gdXNlci5lbWFpbDsKICAgIHRoaXMuZHluYW1pY1ZhbGlkYXRlRm9ybS50ZWwgPSB1c2VyLnRlbDsKICAgIHRoaXMuZHluYW1pY1ZhbGlkYXRlRm9ybS5pZCA9IHVzZXIuaWQ7CiAgICBjb25zb2xlLmxvZyh1c2VyKTsKICAgIAogICAgLy8gY29uc29sZS5sb2codHlwZW9mKHVzZXIuaWQpKTsKICAgIAogICAgLy8gY29uc29sZS5sb2codXNlcik7CgogICAgLy8gICAgdGhpcy5keW5hbWljVmFsaWRhdGVGb3JtLnNjaG9vbCA9IHVzZXIuc2Nob29sCiAgfSwKICBtZXRob2RzOiB7CiAgICBzdWJtaXRGb3JtKGZvcm1OYW1lKSB7CiAgICAgIHRoaXMuJHJlZnNbZm9ybU5hbWVdLnZhbGlkYXRlKHZhbGlkID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIC8vICAgY29uc29sZS5sb2coY29va2llKTsKICAgICAgICAgIHRoaXMuJGNvbmZpcm0oIuaYr+WQpuehruiupOaPkOS6pD8iLCAi5o+Q56S6IiwgewogICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIuehruWumiIsCiAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICLlj5bmtogiLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIKICAgICAgICAgIH0pCiAgICAgICAgICAgIC50aGVuKCgpID0+IHsKICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmR5bmFtaWNWYWxpZGF0ZUZvcm0uaWQpOwogICAgICAgICAgICAgIGVkaXRTZXR0aW5nKHsKICAgICAgICAgICAgICAgIGlkOiB0aGlzLmR5bmFtaWNWYWxpZGF0ZUZvcm0uaWQsCiAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy5keW5hbWljVmFsaWRhdGVGb3JtLmVtYWlsLAogICAgICAgICAgICAgICAgdGVsOiB0aGlzLmR5bmFtaWNWYWxpZGF0ZUZvcm0udGVsCiAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC50aGVuKHJlc3AgPT4gewogICAgICAgICAgICAgICAgICBpZiAocmVzcC5kYXRhLnN0YXR1c0NvZGUgPT09ICIyMDAiKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy50b2FzdChyZXNwLmRhdGEubWVzc2FnZSwgMSk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy50b2FzdChyZXNwLmRhdGEubWVzc2FnZSwgMik7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAuY2F0Y2goZGF0YSA9PiB7CiAgICAgICAgICAgICAgICAgIHRoaXMudG9hc3QoZGF0YSwgMik7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIC8vICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgIC8vICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgIC8vICAgICBtZXNzYWdlOiAi5Liq5Lq65L+h5oGv5pu05paw5oiQ5YqfISIKICAgICAgICAgICAgLy8gICB9KTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLmNhdGNoKCgpID0+IHsKICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgIHR5cGU6ICJpbmZvIiwKICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICLlt7Llj5bmtojmj5DkuqQiCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICByZXNldEZvcm0oZm9ybU5hbWUpIHsKICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0ucmVzZXRGaWVsZHMoKTsKICAgIH0sCiAgICByZW1vdmVEb21haW4oaXRlbSkgewogICAgICB2YXIgaW5kZXggPSB0aGlzLmR5bmFtaWNWYWxpZGF0ZUZvcm0uZG9tYWlucy5pbmRleE9mKGl0ZW0pOwogICAgICBpZiAoaW5kZXggIT09IC0xKSB7CiAgICAgICAgdGhpcy5keW5hbWljVmFsaWRhdGVGb3JtLmRvbWFpbnMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgfQogICAgfSwKICAgIGFkZERvbWFpbigpIHsKICAgICAgdGhpcy5keW5hbWljVmFsaWRhdGVGb3JtLmRvbWFpbnMucHVzaCh7CiAgICAgICAgdmFsdWU6ICIiLAogICAgICAgIGtleTogRGF0ZS5ub3coKQogICAgICB9KTsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["edit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgDA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"edit.vue","sourceRoot":"src/components/user","sourcesContent":["<template>\n  <div class=\"one\">\n    <el-tabs type=\"border-card\">\n      <el-tab-pane>\n        <span slot=\"label\">\n          <i class=\"el-icon-date\"></i> 个人设置\n        </span>\n        <el-form\n          :model=\"dynamicValidateForm\"\n          :rules=\"settingRules\"\n          ref=\"dynamicValidateForm\"\n          label-width=\"100px\"\n          class=\"demo-dynamic\"\n        >\n          <el-form-item prop=\"email\" label=\"邮箱\">\n            <el-input v-model=\"dynamicValidateForm.email\"></el-input>\n          </el-form-item>\n          <el-form-item prop=\"tel\" label=\"手机号\">\n            <el-input v-model=\"dynamicValidateForm.tel\"></el-input>\n          </el-form-item>\n          <!-- <el-form-item prop=\"school\" label=\"学校\">\n            <el-input v-model=\"dynamicValidateForm.school\"></el-input>\n          </el-form-item>-->\n          <!-- <el-form-item prop=\"describe\" label=\"个人介绍\">\n            <el-input v-model=\"dynamicValidateForm.describe\"></el-input>\n          </el-form-item>-->\n\n          <el-form-item>\n            <el-button type=\"primary\" @click=\"submitForm('dynamicValidateForm')\">提交</el-button>\n\n            <el-button @click=\"resetForm('dynamicValidateForm')\">重置</el-button>\n          </el-form-item>\n        </el-form>\n      </el-tab-pane>\n      <!-- <el-tab-pane>\n            <span slot=\"label\"><i class=\"el-icon-date\"></i> 手机设置</span>\n            我的行程\n            \n        </el-tab-pane>\n        <el-tab-pane>\n            <span slot=\"label\"><i class=\"el-icon-date\"></i> 资料设置</span>\n            我的行程\n      </el-tab-pane>-->\n    </el-tabs>\n  </div>\n</template>\n\n<script>\nimport { getCookie, setCookie, removeCookie } from \"@/libs/cookie\";\nimport { editSetting } from \"@/api/modules/user\";\n\nexport default {\n  name: \"edit\",\n  data() {\n    //邮箱验证\n    var userEmail = (rule, value, callback) => {\n      const mailReg = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/;\n      // if (!value) {\n      //   return callback();\n      // }\n      if (!value) {\n        return callback(new Error(\"邮箱不能为空\"));\n      }\n      setTimeout(() => {\n        if (mailReg.test(value)) {\n          callback();\n        } else {\n          callback(new Error(\"请输入正确的邮箱格式\"));\n        }\n      }, 100);\n    };\n    //手机验证\n    var checkPhone = (rule, value, callback) => {\n      const phoneReg = 11 && /^((13|14|15|17|18)[0-9]{1}\\d{8})$/;\n      this.btntxt = \"获取验证码\";\n      this.time = 0;\n      if (!value) {\n        return callback(new Error(\"手机号不能为空\"));\n      }\n      setTimeout(() => {\n        // Number.isInteger是es6验证数字是否为整数的方法,实际输入的数字总是识别成字符串\n        // 所以在前面加了一个+实现隐式转换\n\n        if (!Number.isInteger(+value)) {\n          callback(new Error(\"请输入数字值\"));\n        } else {\n          if (phoneReg.test(value)) {\n            this.time = 60;\n            this.btntxt = \"获取验证码\";\n            this.disabled = false;\n            callback();\n          } else {\n            callback(new Error(\"电话号码格式不正确\"));\n          }\n        }\n      }, 100);\n    };\n    return {\n      dynamicValidateForm: {\n        domains: [\n          {\n            value: \"\"\n          }\n        ],\n        id: \"\",\n        email: \"\",\n        tel: \"\"\n        // school:\"\",\n        // describe:\"\"\n      },\n      settingRules: {\n        email: { validator: userEmail, trigger: \"blur\" },\n        tel: { validator: checkPhone, trigger: \"blur\" }\n      }\n    };\n  },\n  mounted() {\n    let user = JSON.parse(getCookie(\"user\") || \"{}\");\n    this.dynamicValidateForm.email = user.email;\n    this.dynamicValidateForm.tel = user.tel;\n    this.dynamicValidateForm.id = user.id;\n    console.log(user);\n    \n    // console.log(typeof(user.id));\n    \n    // console.log(user);\n\n    //    this.dynamicValidateForm.school = user.school\n  },\n  methods: {\n    submitForm(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          //   console.log(cookie);\n          this.$confirm(\"是否确认提交?\", \"提示\", {\n            confirmButtonText: \"确定\",\n            cancelButtonText: \"取消\",\n            type: \"warning\"\n          })\n            .then(() => {\n              // console.log(this.dynamicValidateForm.id);\n              editSetting({\n                id: this.dynamicValidateForm.id,\n                email: this.dynamicValidateForm.email,\n                tel: this.dynamicValidateForm.tel\n              })\n                .then(resp => {\n                  if (resp.data.statusCode === \"200\") {\n                    this.toast(resp.data.message, 1);\n                  } else {\n                    this.toast(resp.data.message, 2);\n                  }\n                })\n                .catch(data => {\n                  this.toast(data, 2);\n                });\n\n            //   this.$message({\n            //     type: \"success\",\n            //     message: \"个人信息更新成功!\"\n            //   });\n            })\n            .catch(() => {\n              this.$message({\n                type: \"info\",\n                message: \"已取消提交\"\n              });\n            });\n        } else {\n          return false;\n        }\n      });\n    },\n    resetForm(formName) {\n      this.$refs[formName].resetFields();\n    },\n    removeDomain(item) {\n      var index = this.dynamicValidateForm.domains.indexOf(item);\n      if (index !== -1) {\n        this.dynamicValidateForm.domains.splice(index, 1);\n      }\n    },\n    addDomain() {\n      this.dynamicValidateForm.domains.push({\n        value: \"\",\n        key: Date.now()\n      });\n    }\n  }\n};\n</script>\n\n<style scoped>\n.one {\n  border-style: solid;\n  border-width: 0.1px;\n  border-radius: 10px;\n  border-color: #edeeef;\n  background-color: white;\n  height: 800px;\n  width: 70%;\n  margin: 0 auto;\n  margin-top: 3%;\n}\n</style>"]}]}