{"remainingRequest":"/Users/xiekun/Pictures/sabi/dasabi/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/xiekun/Pictures/sabi/dasabi/src/components/user/edit.vue?vue&type=style&index=0&id=3a47aaee&scoped=true&lang=css&","dependencies":[{"path":"/Users/xiekun/Pictures/sabi/dasabi/src/components/user/edit.vue","mtime":1593668399406},{"path":"/Users/xiekun/Pictures/sabi/dasabi/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xiekun/Pictures/sabi/dasabi/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/xiekun/Pictures/sabi/dasabi/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/xiekun/Pictures/sabi/dasabi/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xiekun/Pictures/sabi/dasabi/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5vbmUgewogIGJvcmRlci1zdHlsZTogc29saWQ7CiAgYm9yZGVyLXdpZHRoOiAwLjFweDsKICBib3JkZXItcmFkaXVzOiAxMHB4OwogIGJvcmRlci1jb2xvcjogI2VkZWVlZjsKICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTsKICBoZWlnaHQ6IDgwMHB4OwogIHdpZHRoOiA3MCU7CiAgbWFyZ2luOiAwIGF1dG87CiAgbWFyZ2luLXRvcDogMyU7Cn0K"},{"version":3,"sources":["edit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"edit.vue","sourceRoot":"src/components/user","sourcesContent":["<template>\n  <div class=\"one\">\n    <el-tabs type=\"border-card\">\n      <el-tab-pane>\n        <span slot=\"label\">\n          <i class=\"el-icon-date\"></i> 个人设置\n        </span>\n        <el-form\n          :model=\"dynamicValidateForm\"\n          :rules=\"settingRules\"\n          ref=\"dynamicValidateForm\"\n          label-width=\"100px\"\n          class=\"demo-dynamic\"\n        >\n          <el-form-item prop=\"email\" label=\"邮箱\">\n            <el-input v-model=\"dynamicValidateForm.email\"></el-input>\n          </el-form-item>\n          <el-form-item prop=\"tel\" label=\"手机号\">\n            <el-input v-model=\"dynamicValidateForm.tel\"></el-input>\n          </el-form-item>\n          <!-- <el-form-item prop=\"school\" label=\"学校\">\n            <el-input v-model=\"dynamicValidateForm.school\"></el-input>\n          </el-form-item>-->\n          <!-- <el-form-item prop=\"describe\" label=\"个人介绍\">\n            <el-input v-model=\"dynamicValidateForm.describe\"></el-input>\n          </el-form-item>-->\n\n          <el-form-item>\n            <el-button type=\"primary\" @click=\"submitForm('dynamicValidateForm')\">提交</el-button>\n\n            <el-button @click=\"resetForm('dynamicValidateForm')\">重置</el-button>\n          </el-form-item>\n        </el-form>\n      </el-tab-pane>\n      <!-- <el-tab-pane>\n            <span slot=\"label\"><i class=\"el-icon-date\"></i> 手机设置</span>\n            我的行程\n            \n        </el-tab-pane>\n        <el-tab-pane>\n            <span slot=\"label\"><i class=\"el-icon-date\"></i> 资料设置</span>\n            我的行程\n      </el-tab-pane>-->\n    </el-tabs>\n  </div>\n</template>\n\n<script>\nimport { getCookie, setCookie, removeCookie } from \"@/libs/cookie\";\nimport { editSetting } from \"@/api/modules/user\";\n\nexport default {\n  name: \"edit\",\n  data() {\n    //邮箱验证\n    var userEmail = (rule, value, callback) => {\n      const mailReg = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/;\n      // if (!value) {\n      //   return callback();\n      // }\n      if (!value) {\n        return callback(new Error(\"邮箱不能为空\"));\n      }\n      setTimeout(() => {\n        if (mailReg.test(value)) {\n          callback();\n        } else {\n          callback(new Error(\"请输入正确的邮箱格式\"));\n        }\n      }, 100);\n    };\n    //手机验证\n    var checkPhone = (rule, value, callback) => {\n      const phoneReg = 11 && /^((13|14|15|17|18)[0-9]{1}\\d{8})$/;\n      this.btntxt = \"获取验证码\";\n      this.time = 0;\n      if (!value) {\n        return callback(new Error(\"手机号不能为空\"));\n      }\n      setTimeout(() => {\n        // Number.isInteger是es6验证数字是否为整数的方法,实际输入的数字总是识别成字符串\n        // 所以在前面加了一个+实现隐式转换\n\n        if (!Number.isInteger(+value)) {\n          callback(new Error(\"请输入数字值\"));\n        } else {\n          if (phoneReg.test(value)) {\n            this.time = 60;\n            this.btntxt = \"获取验证码\";\n            this.disabled = false;\n            callback();\n          } else {\n            callback(new Error(\"电话号码格式不正确\"));\n          }\n        }\n      }, 100);\n    };\n    return {\n      dynamicValidateForm: {\n        domains: [\n          {\n            value: \"\"\n          }\n        ],\n        id: \"\",\n        email: \"\",\n        tel: \"\"\n        // school:\"\",\n        // describe:\"\"\n      },\n      settingRules: {\n        email: { validator: userEmail, trigger: \"blur\" },\n        tel: { validator: checkPhone, trigger: \"blur\" }\n      }\n    };\n  },\n  mounted() {\n    let user = JSON.parse(getCookie(\"user\") || \"{}\");\n    this.dynamicValidateForm.email = user.email;\n    this.dynamicValidateForm.tel = user.tel;\n    this.dynamicValidateForm.id = user.id;\n    console.log(user);\n    \n    // console.log(typeof(user.id));\n    \n    // console.log(user);\n\n    //    this.dynamicValidateForm.school = user.school\n  },\n  methods: {\n    submitForm(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          //   console.log(cookie);\n          this.$confirm(\"是否确认提交?\", \"提示\", {\n            confirmButtonText: \"确定\",\n            cancelButtonText: \"取消\",\n            type: \"warning\"\n          })\n            .then(() => {\n              // console.log(this.dynamicValidateForm.id);\n              editSetting({\n                id: this.dynamicValidateForm.id,\n                email: this.dynamicValidateForm.email,\n                tel: this.dynamicValidateForm.tel\n              })\n                .then(resp => {\n                  if (resp.data.statusCode === \"200\") {\n                    this.toast(resp.data.message, 1);\n                  } else {\n                    this.toast(resp.data.message, 2);\n                  }\n                })\n                .catch(data => {\n                  this.toast(data, 2);\n                });\n\n            //   this.$message({\n            //     type: \"success\",\n            //     message: \"个人信息更新成功!\"\n            //   });\n            })\n            .catch(() => {\n              this.$message({\n                type: \"info\",\n                message: \"已取消提交\"\n              });\n            });\n        } else {\n          return false;\n        }\n      });\n    },\n    resetForm(formName) {\n      this.$refs[formName].resetFields();\n    },\n    removeDomain(item) {\n      var index = this.dynamicValidateForm.domains.indexOf(item);\n      if (index !== -1) {\n        this.dynamicValidateForm.domains.splice(index, 1);\n      }\n    },\n    addDomain() {\n      this.dynamicValidateForm.domains.push({\n        value: \"\",\n        key: Date.now()\n      });\n    }\n  }\n};\n</script>\n\n<style scoped>\n.one {\n  border-style: solid;\n  border-width: 0.1px;\n  border-radius: 10px;\n  border-color: #edeeef;\n  background-color: white;\n  height: 800px;\n  width: 70%;\n  margin: 0 auto;\n  margin-top: 3%;\n}\n</style>"]}]}